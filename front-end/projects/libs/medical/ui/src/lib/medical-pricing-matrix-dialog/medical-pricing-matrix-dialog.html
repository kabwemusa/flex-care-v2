<div class="flex flex-col h-[90vh] max-w-5xl bg-white overflow-hidden">
  <div class="p-6 border-b bg-slate-50 flex justify-between items-center">
    <div>
      <h2 class="text-2xl font-black text-slate-900 uppercase tracking-tight">Price Matrix</h2>
      <p class="text-sm text-slate-500">
        Defining premiums for:
        <span class="font-bold text-indigo-600">{{ data.rateCard.name }}</span>
      </p>
    </div>
    <button mat-icon-button (click)="ref.close()"><mat-icon>close</mat-icon></button>
  </div>

  <div class="flex-1 overflow-y-auto p-6">
    <table class="w-full text-left border-collapse">
      <thead>
        <tr class="text-[10px] font-black uppercase text-slate-400 tracking-widest border-b">
          <th class="pb-3 pl-2">Min Age</th>
          <th class="pb-3">Max Age</th>
          <th class="pb-3">Member Type</th>
          <th class="pb-3">Price ({{ data.rateCard.currency }})</th>
          <th class="pb-3 text-right"></th>
        </tr>
      </thead>
      <tbody class="divide-y divide-slate-100">
        @for (entry of entries(); track $index) {
        <tr class="hover:bg-slate-50 group">
          <td class="py-2 pl-2">
            <input
              type="number"
              [(ngModel)]="entry.min_age"
              class="w-20 bg-transparent border-b border-transparent focus:border-blue-500 focus:outline-none py-1 font-mono"
            />
          </td>
          <td class="py-2">
            <input
              type="number"
              [(ngModel)]="entry.max_age"
              class="w-20 bg-transparent border-b border-transparent focus:border-blue-500 focus:outline-none py-1 font-mono"
            />
          </td>
          <td class="py-2">
            <select
              [(ngModel)]="entry.member_type"
              class="bg-transparent border-b border-transparent focus:border-blue-500 focus:outline-none py-1 text-sm font-semibold"
            >
              <option value="Principal">Principal</option>
              <option value="Spouse">Spouse</option>
              <option value="Child">Child</option>
            </select>
          </td>
          <td class="py-2">
            <div class="flex items-center gap-1">
              <span class="text-slate-300 text-xs font-bold">{{ data.rateCard.currency }}</span>
              <input
                type="number"
                [(ngModel)]="entry.price"
                class="w-32 bg-transparent border-b border-transparent focus:border-blue-500 focus:outline-none py-1 font-bold text-slate-800"
              />
            </div>
          </td>
          <td class="py-2 text-right">
            <button
              mat-icon-button
              color="warn"
              class="opacity-0 group-hover:opacity-100 transition-opacity"
              (click)="removeRow($index)"
            >
              <mat-icon>delete_outline</mat-icon>
            </button>
          </td>
        </tr>
        }
      </tbody>
    </table>

    <button
      mat-button
      color="primary"
      class="mt-6 w-full py-4 border-2 border-dashed border-blue-100 rounded-xl"
      (click)="addRow()"
    >
      <mat-icon class="mr-2">add_circle</mat-icon> Add Age Band Row
    </button>
  </div>

  <div class="p-6 border-t bg-slate-50 flex justify-end gap-3">
    <button mat-button (click)="ref.close()">Cancel</button>
    <button
      mat-flat-button
      color="primary"
      class="px-10 rounded-lg shadow-lg shadow-blue-100"
      [disabled]="entries().length === 0"
      (click)="save()"
    >
      Save All Changes
    </button>
  </div>
</div>
