<div class="p-6 max-w-lg">
  <h2 class="text-2xl font-bold text-slate-800 mb-6 tracking-tight">
    {{ data?.id ? 'Edit Plan' : 'Add New Tier' }}
  </h2>

  <form [formGroup]="planForm" (ngSubmit)="save()" class="space-y-5">
    <mat-form-field appearance="fill" class="w-full">
      <mat-label>Umbrella Scheme</mat-label>
      <mat-select formControlName="scheme_id">
        @for (scheme of schemeStore.schemes(); track scheme.id) {
        <mat-option [value]="scheme.id">{{ scheme.name }}</mat-option>
        }
      </mat-select>
      @if (planForm.get('scheme_id')?.hasError('required')) {
      <mat-error>You must link this plan to a scheme</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="fill" class="w-full">
      <mat-label>Plan Name (Tier)</mat-label>
      <input matInput formControlName="name" placeholder="e.g. Executive Gold" />
    </mat-form-field>

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <mat-form-field appearance="fill" class="w-full">
        <mat-label>Plan Type</mat-label>
        <mat-select formControlName="type">
          @for (type of ['Individual', 'Family', 'SME', 'Corporate']; track type) {
          <mat-option [value]="type">{{ type }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    </div>

    <div class="flex justify-end gap-3 pt-4">
      <button type="button" mat-button (click)="ref.close()">Cancel</button>
      <button
        mat-flat-button
        color="primary"
        [disabled]="planForm.invalid"
        type="submit"
        class="px-8 rounded-lg shadow-sm"
      >
        Save Plan
      </button>
    </div>
  </form>
</div>
