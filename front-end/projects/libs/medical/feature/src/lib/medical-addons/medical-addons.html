<div class="p-8 bg-slate-50 min-h-screen">
  <div class="flex justify-between items-center mb-8">
    <div>
      <h1 class="text-3xl font-bold text-slate-900 tracking-tight">Optional Add-ons</h1>
      <p class="text-slate-500">Manage premium-based bolt-on covers for medical plans.</p>
    </div>
    <button
      mat-flat-button
      color="primary"
      class="rounded-xl py-6 px-6 shadow-lg shadow-blue-100"
      (click)="openDialog()"
    >
      <mat-icon class="mr-2">library_add</mat-icon> Create Add-on
    </button>
  </div>

  @if (store.isLoading()) {
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 animate-pulse">
    @for (i of [1,2,3]; track i) {
    <div class="h-48 bg-slate-200 rounded-2xl"></div>
    }
  </div>
  } @else {
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    @for (addon of store.addons(); track addon.id) {
    <div
      class="group bg-white rounded-2xl border border-slate-200 p-6 transition-all hover:shadow-xl hover:border-blue-200 relative overflow-hidden"
    >
      <div class="absolute top-4 right-4">
        <span
          [class]="addon.is_mandatory ? 'bg-emerald-50 text-emerald-600' : 'bg-red-50 text-red-600'"
          class="text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-widest"
        >
          {{ addon.is_mandatory ? 'Mandatory' : 'Optional' }}
        </span>
      </div>

      <h3 class="text-xl font-bold text-slate-800 mb-2">{{ addon.name }}</h3>
      <p class="text-sm text-slate-500 line-clamp-2 mb-6 h-10">
        {{ addon.description || 'No description provided.' }}
      </p>

      <div class="flex items-center justify-between border-t pt-4">
        <div>
          <span class="text-xs text-slate-400 block uppercase font-bold tracking-tighter"
            >Monthly Premium</span
          >
          <span class="text-2xl font-black text-slate-900"
            >K{{ addon.price | number : '1.2-2' }}</span
          >
        </div>

        <button
          mat-icon-button
          [matMenuTriggerFor]="menu"
          class="text-slate-400 hover:text-slate-600"
        >
          <mat-icon>more_vert</mat-icon>
        </button>
      </div>

      <mat-menu #menu="matMenu">
        <button mat-menu-item (click)="openDialog(addon)">
          <mat-icon>edit</mat-icon> Edit Details
        </button>
        <button mat-menu-item class="text-red-600" (click)="delete(addon.id!)">
          <mat-icon class="text-red-600">delete</mat-icon> Remove
        </button>
      </mat-menu>
    </div>
    } @empty {
    <div
      class="col-span-full py-20 text-center bg-white rounded-3xl border-2 border-dashed border-slate-200"
    >
      <mat-icon class="text-slate-300 scale-[2] mb-4">extension_off</mat-icon>
      <p class="text-slate-500 font-medium">No medical add-ons found in the library.</p>
    </div>
    }
  </div>
  }
</div>
